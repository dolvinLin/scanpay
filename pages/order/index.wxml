<!--pages/order/index.wxml-->
<!-- <text>pages/order/index.wxml</text> -->
<view class="goods" wx:for="{{goodsList}}" wx:key="index">
  <view class="price">ï¿¥{{item.price}}</view>
  <view class="title">{{item.title}}</view>
  <view class="num">Ã—{{item.num}}</view>
</view>
<view class="more" wx:if="{{isMore}}">å…±2ä»¶å•†å“ å±•å¼€ğŸ’¦</view>
<view class="balance wrap">
  <view class="left">
    <text>ä½™é¢</text><text class="price">(ï¿¥{{balance}})</text>
  </view>
  <switch checked="{{isBalance}}" bindchange="switchBalance" />
</view>
<view class="goods-price wrap">
  <text>å•†å“é‡‘é¢</text>
  <text class="price">ï¿¥{{computed.cart(goodsList,balance,isBalance).result}}</text>
</view>
<view class="discount wrap" wx:if="{{isBalance}}">
  <text>ä½™é¢æŠ˜æ‰£</text>
  <text class="price">-{{balance}}</text>
</view>
<view class="tip">
  <icon type="warn" size="22" color="#999"></icon><text>è¯·æ”¯ä»˜å®Œæˆåæºå¸¦å•†å“</text>
</view>
<view class="footer">
  <view class="add">å®é™…æ”¯ä»˜ï¼š<text class="price">ï¿¥{{computed.cart(goodsList,balance,isBalance).discountPrice}}</text></view>
  <view class="pay" bindtap="handlePay">ç¡®è®¤æ”¯ä»˜</view>
</view>
<wxs module="computed">
  var cart = function (cart, balance, isBalance) {
    var result = 0;
    var discountPrice = 0;
    cart.forEach(function (item) {
      result += item.num * item.price;
    });
    if (isBalance) {
      discountPrice = result - balance
    } else {
      discountPrice = result
    }

    result = result.toFixed(2);
    return { result, discountPrice }
  };
  module.exports = { cart: cart };
</wxs>